# 鸿蒙开发教程学习

## 1.FA模型与STAGE模型区别

FA将UI/UI逻辑/业务逻辑/数据/和数据逻辑混为一谈，而STAGE模型恰好避免了这个问题



## 2.Arkts语言学习

### 1.联合类型：

let 变量名：属性A | 属性B | 属性C = 

举例： let judge: number | string | = 100;   judge = 'A';



变量限制在一定数据范围内？

let gender: 'man' | 'woman' | 'secret'  //这样gender只能在man/woman/secret中选择



### 2.枚举类型

`enum 枚举名 {常量1 = 值, 常量2 = 值, ````}` 

 `enum ThemeColor {`

​	`Red = 'XXX',`

​	`Orange = 'QQQ',`

​	`Green = 'WWW'`

`}`

取值let color: ThemeColor = ThemeColor.Red;



## 3.界面开发

### 1.布局思路

1.ArkUi（方舟开发框架）是一套构建鸿蒙应用界面的框架，构建页面的最小单位是“组件”。

2.组件分类：

a.基础组件：界面呈现的**基础元素**。如文字、图片、按钮等 Text('内容')

b.容器组件：控制**布局排布**。如ROW行、Column列等

 3.布局思路？

先排版，再放内容。**注意：build有且只能有一个根元素，且是容器组件**，如果是两个根组件就报错：

build() {

​	column(){}

​	row(){}

}必须是如下形式：

build() {

​	column() {

​		column(){}

​		row(){}

​	}

}



### 2.组件的属性方法

需求：美化组件外观效果->组件的属性方法

1.美化组件外观效果->调用组件的属性方法

2.组件属性方法怎么写？

![image-20250702075605408](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250702075605408.png)

![image-20250702075634941](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250702075634941.png)

### 3.文本设置

1.文本颜色

2.文本溢出省略号、行高

.textOverflow({

​	ovverflow: TextOverflow

}).maxLines(3)



.lineheight(24)

![image-20250724074251271](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250724074251271.png)

### 4.图片组件

有本地/网络两种打开图片的方式

 1.添加网络图片

Image('https://wwwXXXX').height(50)

2.本地图片加载

Image($r('app.media.文件名'))

### 5.输入框和按钮

![image-20250702230655534](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250702230655534.png)

```
build() {
  Column({space: 10}) { //设置了每列的间隙
    TextInput({
      placeholder: '请输入用户名'
    })
    TextInput({
      placeholder: '请输入密码'
    }).type(InputType.Password)
    Button('登录').width(200)
  }
}
```

### 6.布局元素组成以及内外边距

![image-20250703075530495](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250703075530495.png)

内边距（内容和组件边距有距离，那就使用内边距）语法：

![image-20250703075548648](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250703075548648.png)

外边距（两个组件之间有距离）语法：

![image-20250703075721109](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250703075721109.png)

针对内外边距四个方向距离不同，使用如下方式：

![image-20250724075303736](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250724075303736.png)

添加边框：

![image-20250703080006093](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250703080006093.png)

圆角设置：

![image-20250703080556521](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250703080556521.png)

特殊圆形设置：

![image-20250703231750030](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250703231750030.png)

**背景图片：**

Text('我是文本').backgroundImage($r('app.media.xx'), ImageRepeat.XY)

**背景图片位置：**

**//backgroundImag**ePosition(Alignment.Center)   Alignment.TopStart Alignment.BottomEnd

Text('我是文本').backgroundImage($r('app.media.xx'), ImageRepeat.XY).backgroundImagePosition({x: 100, y: 100}) 

**背景图默认单位：**

px:实际物理像素点，设备出厂，根据手机能力就定好了分辨率单位

vp:虚拟像素，相对于不同设备会自动转换，保证不同设备视觉一致

**背景图尺寸：**

.backgroundImageSize(宽高对象 或 枚举)

参数：背景图宽高： {width:尺寸， height:尺寸} 

枚举ImageSize: contain/cover/auto

### 7.滚动组件

```
List() {  //List组件
	ListItem() { //组件里面的每一块内容
	
	}
	ListItem() { //组件里面的每一块内容
	
	}````
	.scrollBar(BarState.Off) //关闭滑动条显示
}
```

### 8.点击事件与状态管理

```
状态变量：使用装饰器修饰，状态变量数据改变会引起UI的渲染刷新
@ComponentV2
struct Index {
	@Local num: number = 1
}

onclick() {
	this.num++;
	this.num--;
}
```

### 9.@builder

@builder的函数也称为“自定义构建函数”,它的作用是封装UI元素，提升复用性 

```
@Builder
自定义构建函数名字(参数列表) {
	要复用的组件结构
}
```

### 10.ForEach

```
ForEach(数组名, (数组类型, 索引)=> {
	
})

example:
songs: SongItemType[] = [...] 
ForEach(this.songs, (item: SongItemType, index: number)=>{

})
```

### 11.歌单交互效果

播放状态：

播放状态组件(层叠Stack)->状态变量@Local（正在播放索引）->条件渲染播放状态组件->点击事件修改状态变量

![image-20250726074753451](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250726074753451.png)

![image-20250726074911997](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250726074911997.png)

**响应onClick后，更改了状态变量的值，**条件渲染了播放状态组件，所以UI界面的动态图会改变。

![image-20250726075144918](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250726075144918.png)



### 12.Navigation组件-页面跳转

  

### 13.设计一个黑马云音乐细节

1.组件声明周期自动执行，组件运行到3s后，自动执行相关代码

```
aboutToAppear():void {
	setTimeout(() => {
		this.pageStack.replacePathByName("Layout", null, false)
	}, 3000)
}
```

Tabs组件切换不同组件内容

![image-20250727224822074](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250727224822074.png)

```
Tabs({barPosition: BarPosition.End}) {
	TabContent() {
		//内容
	}
		.tabBar() //菜单
}
```

针对这个场景，可以使用循环渲染功能

```
interface TabClass{
	text: string
	icon: ResourceStr
}
tabData: TabClass[] = [
 {text: '推荐'， icon:},
 {text: '发现'， icon:},
 {text: '动态'， icon:},
 {text: '我的'， icon:},
]
@Builder
tabBuilder(item: TabClass) }{
	Column({ space:5 }) {
		Image(item.icon) 
			.width(24)
		.text(item.text)
	}
}

@Local curerentIndex: number = 0;
Tabs({barPosition: BarPosition.End}) {
	ForEach(this.tabData, (item: TabClass, index: number) = {
		TabContent() {
		
		}
		.tabBar(item.text) //如果想要自定义导航栏，那就需要使用builder .tabBar(this.tabBuilder(item))
	})
}
.onChange(index: number) {
	this.currentIndex = index;  //点击tabs切换不同组件的时候，可以通过这个获取索引，然后在build里面设置对应的颜色
}
```

通过onChange来设置tabs不同组件颜色

![image-20250728074326980](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250728074326980.png)

- TextInput组件：信息提示框

  ```
  TextInput({placeholder: '只因你太美'})  //placeholder:提示文字
  	.placeholderColor()
  ```

- Swiper组件：轮播功能

  ```
  Swiper() {
  	//内容
  }
  	.autoplay(true) //自动播放
  ```

- List组件：List组件使用默认是列添加，如果需要修改为行添加

  ```
  List() {
  	ForEach({})
  }
  	.listDirection(Axis.Horizontal)
  ```

- Text组件

  ```
  Text('内容')
  	.maxLines(2) //表示内容最多显示2行
  	.textOverflow({overflow: TextOverflow.ellipsis}) //多余的内容显示省略号
  ```

- 非Navigation子页如何实现页面跳转？
  全局共享NavPathStack
  AppStorageV2:提供状态变量在应用级全局共享的能力

  **如何使用AppStorageV2?**

```
AppStorageV2.connect(NavPathStack, 'navStack', ()=>new NavPathStack())!
```

- 类属性变化观测

 @ObservedV2装饰器和@Trace装饰器用来观测类属性变化，类似@Local

@Trace装饰器装饰的属性property变化时，仅会通知property关联的组件进行刷新

- 控制播放进度

```
Slider({
	value: 当前播放时间，
	min: 0,
	max: 歌曲总时长
})
	.onChange((value) => {
		播放器.seek(value) //跳转到指定播放器位置
	})
```

- swipeAction 侧滑

![image-20250803175916102](C:\Users\73985\AppData\Roaming\Typora\typora-user-images\image-20250803175916102.png)

- 如果实现后台播放或息屏播放，需要介入**AVsession**(媒体会话)和申请长时任务，避免播放被系统强制中断

当需要实现后台播放等功能时，需要使用BackgroundTasks Kit(后台任务管理)的能力，申请对应长时任务，避免进入挂起（suspend）状态